(this.webpackJsonpbeepboop=this.webpackJsonpbeepboop||[]).push([[0],{113:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),r=n.n(c),s=n(26),i=n.n(s),o=(n(38),n(3)),u=(n(39),n(8)),l=n(15),d=n.n(l),j=n(4),b=n.n(j),h=n(27),O=n.n(h),f=n(7),p=n(16),m=n.n(p);m.a.setLevel("ERROR");var x=m.a;function v(e){var t=Object(c.useContext)(H);return Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:Object(a.jsx)("div",{className:"section-header",children:Object(a.jsx)("div",{className:"section-header-title",onClick:function(){window.open("https://habitica.com/")},children:Object(a.jsx)("h2",{children:e.title})})})}),t.dates.map((function(e){return Object(a.jsx)("th",{children:Object(a.jsxs)("div",{className:"date date-heading",children:[Object(a.jsx)("span",{children:e.format("ddd")}),Object(a.jsx)("span",{children:e.format("DD")})]})},e.toString())}))]})})}var y=n(28),w=n(17);function N(e){var t=Object(c.useContext)(H),n=new Map,r=e.habit,s=r.text,i=r.history;x.debug(s);var o,u=Object(y.a)(i);try{for(u.s();!(o=u.n()).done;){var l=o.value,d=b()(l.date).format(U);x.debug(JSON.stringify(l)),void 0!==l.scoredUp&&void 0!==l.scoredDown&&n.set(d,[l.scoredUp,l.scoredDown])}}catch(h){u.e(h)}finally{u.f()}var j=t.dates.map((function(e){return e.format(U)})).map((function(e){return{day:e,score:n.get(e)}}));return 0!==j.filter((function(e){return void 0!==e.score})).length||e.showNoHistory?Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{className:"task-name-row",children:Object(a.jsx)("span",{className:"task-name",dangerouslySetInnerHTML:{__html:w.render(s)}})}),j.map((function(e){var t=e.day,n=e.score;return n?Object(a.jsx)(g,{up:n[0],down:n[1]},t):t!==b()(new Date).format(U)?Object(a.jsx)("td",{className:"habit-cell",children:Object(a.jsx)("div",{className:"habit-score-container",children:Object(a.jsx)("div",{className:"fail center-wrapper",children:Object(a.jsx)("span",{children:"\u2716"})})})},t):Object(a.jsx)("td",{className:"habit-cell",children:"\xa0"},t)}))]}):null}function g(e){var t=e.up>=4?"success":"fail";return Object(a.jsx)("td",{className:"habit-cell",children:Object(a.jsx)("div",{className:"habit-score-container",children:e.up>0?Object(a.jsx)("div",{className:[t,"center-wrapper"].join(" "),children:Object(a.jsxs)("span",{children:["+",e.up]})}):Object(a.jsx)("div",{className:"fail center-wrapper",children:Object(a.jsx)("span",{children:e.up})})})})}var S=n(17);function E(e){var t=Object(c.useState)(!0),n=Object(o.a)(t,2),r=n[0],s=n[1];return Object(a.jsxs)("section",{className:"dailys",children:[Object(a.jsxs)("table",{children:[Object(a.jsx)(v,{title:"Habits",setShowNoHistory:s,showNoHistory:r}),Object(a.jsx)("tbody",{children:e.data.map((function(e){return"habit"===e.type?Object(a.jsx)(N,{showNoHistory:r,habit:e},e.id):Object(a.jsx)(R,{showNoHistory:r,daily:e},e.id)}))})]}),Object(a.jsx)("div",{className:"link show-no-history",onClick:function(){return s(!r)}})]})}function R(e){var t=Object(c.useContext)(H),n=new Map,r=e.daily,s=r.text,i=r.history;x.debug(s);for(var o=1;o<i.length;o++){var u=i[o].value-i[o-1].value,l=b()(i[o].date);if(x.debug(l.format("YYYY-MM-DD HH:mm:ss")+": "+i[o].value),0!==u){if(t.cronIntervals.search(l.unix(),l.unix()).length>0){var d=l.subtract(1,"day");n.has(d.format(U))?n.has(l.format(U))&&x.warn("Too many completions for ".concat(s," on ").concat(l)):l=d}var j=l.format(U);n.set(j,u)}}console.groupEnd();var h=t.dates.map((function(e){return e.format(U)})).map((function(e){return{day:e,delta:n.get(e)}}));return 0!==h.filter((function(e){return void 0!==e.delta})).length||e.showNoHistory?Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{className:"task-name-row",children:Object(a.jsx)("span",{className:"task-name",dangerouslySetInnerHTML:{__html:S.render(s)}})}),h.map((function(e){var t=e.day,n=e.delta;return Object(a.jsx)(k,{delta:n},t)}))]}):null}function k(e){var t,n=["daily-cell"];return e.delta&&0!==e.delta?e.delta>0?(n.push("success"),t="\u2713"):(n.push("fail"),t="\u2716"):(n.push("pass"),t="\xa0"),Object(a.jsx)("td",{className:n.join(" "),children:t&&Object(a.jsx)("div",{className:"center-wrapper",children:Object(a.jsx)("span",{className:"symbol",children:t})})})}var C="https://habitica.com/api/v3",T="0d9428fd-d6fa-45f3-a4db-f130e3ef10ea-HabiticaTracker",D="/tasks/user";function I(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}function P(){return e=2e3,t=5e3,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e);var e,t}function _(e){var t=~~(e/3600),n=~~(e%3600/60),a=~~e%60,c="";return t>0&&(c+=t+":"+(n<10?"0":"")),c+=n+":"+(a<10?"0":""),c+=""+a}var H=r.a.createContext({showTaskIcons:!1,dates:Array(),cronIntervals:new d.a});function M(e){var t=Object(c.useState)(I()),n=Object(o.a)(t,2),r=n[0],s=n[1],i=Object(c.useState)(!1),l=Object(o.a)(i,2),j=l[0],h=l[1],p=Object(c.useState)(P()),m=Object(o.a)(p,2),v=m[0],y=m[1],w=Object(c.useState)(!0),N=Object(o.a)(w,2),g=N[0],S=N[1],R=Object(c.useState)(!0),k=Object(o.a)(R,2),M=k[0],A=k[1],U=Object(c.useState)(!0),Y=Object(o.a)(U,2),L=Y[0],J=Y[1],W=Object(c.useState)(7),F=Object(o.a)(W,2),B=F[0],K=(F[1],Object(c.useState)(!1)),z=Object(o.a)(K,2),G=z[0],$=(z[1],Object(c.useState)([])),q=Object(o.a)($,2),Q=q[0],V=q[1],X=Object(c.useState)([]),Z=Object(o.a)(X,2),ee=Z[0],te=Z[1],ne=Object(c.useState)([]),ae=Object(o.a)(ne,2),ce=ae[0],re=ae[1],se=Object(c.useState)([]),ie=Object(o.a)(se,2),oe=(ie[0],ie[1]),ue=Object(c.useState)(!1),le=Object(o.a)(ue,2),de=le[0],je=le[1],be=Object(c.useState)(1500),he=Object(o.a)(be,2),Oe=he[0],fe=he[1],pe=Object(c.useRef)(Oe);pe.current=Oe;var me=e.userId,xe=e.userApiKey,ve=function(e){return fetch(e,{method:"GET",headers:{"Content-Type":"application/json","x-api-user":me,"x-api-key":xe,"x-client":T}})},ye=function(e){if(!e.success)throw new Error(e.message);return e},we=e.setError,Ne=function(){return ve(C+D).then((function(e){return e.json()})).then(ye).then((function(e){te(e.data.filter((function(e){return"habit"===e.type}))),re(e.data.filter((function(e){return"daily"===e.type}))),A(!1),console.log(C+D,JSON.stringify(e))}),(function(e){we(e)}))},ge=function(e){return fetch(C+"/tasks/"+e+"/score/up",{method:"POST",headers:{"Content-Type":"application/json","x-api-user":me,"x-api-key":xe,"x-client":T}}).then((function(e){return e.json()})).then(ye).then((function(t){h(!0),console.log(C+"/tasks/"+e+"/score/up",JSON.stringify(t))}),(function(e){we(e)})).then(Ne)};Object(c.useEffect)((function(){function e(){s(I())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),Object(c.useEffect)((function(){ve(C+"/user").then((function(e){return e.json()})).then(ye).then((function(e){V(e.data.history.exp.map((function(e){var t=b()(e.date);return[t.unix()-300,t.unix()+300]}))),S(!1)}),(function(e){we(e)}))}),[]),Object(c.useEffect)((function(){Ne()}),[]),Object(c.useEffect)((function(){ve(C+"/tasks/user?type=completedTodos").then((function(e){return e.json()})).then(ye).then((function(e){oe(e.data.filter((function(e){return"todo"===e.type}))),J(!1)}),(function(e){we(e)}))}),[]);var Se=function(){var e=pe.current-1;fe(e),0===e?Re():Ee()},Ee=function(){return setTimeout(Se,1e3)},Re=function(){je(!1),fe(1500),ge("ec59d7c1-e692-4b17-b2e0-6b6a76aedcc3")};if(g||M||L)return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)("p",{children:"Loading..."})});var ke=new d.a;Q.forEach((function(e){x.debug("cron: ".concat(b.a.unix(e[0])," - ").concat(b.a.unix(e[1]))),ke.insert(e[0],e[1],!0)}));var Ce,Te={showTaskIcons:G,dates:(Ce=B,Array(Ce).fill(0).map((function(e,t){return t})).reverse().map((function(e){return b()().subtract(e,"day").startOf("day")}))),cronIntervals:ke};return Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(H.Provider,{value:Te,children:[Object(a.jsx)(E,{data:[].concat(Object(u.a)(ce.slice(0,-1)),Object(u.a)(ee),Object(u.a)(ce.slice(-1)))}),Object(a.jsxs)("div",{className:"buttons-container",children:[Object(a.jsx)("div",{className:"button-container",children:Object(a.jsx)(f.a,{variant:"outline-success",onClick:function(){return ge("b85dc3ec-7836-4827-aa68-e7e605c1489e")},children:"\u2713 Daily Goal"})}),Object(a.jsx)("div",{className:"button-container",children:Object(a.jsx)(f.a,{variant:"outline-success",onClick:de?void 0:function(){je(!0),Ee(),alert("Affirm: Who do I want to be?\n\nWhat do I want to accomplish right now?\n\nBreakdown the task.")},children:de?_(Oe):"\u2713 Pomodoro"})}),Object(a.jsx)("div",{className:"button-container",children:Object(a.jsx)(f.a,{variant:"outline-success",onClick:function(){return ge("13ab931b-b04a-47f0-9555-ad3bc4428dd6")},children:"\u2713 Reflect"})})]}),Object(a.jsx)(O.a,{width:r.width,height:r.height,run:j,onConfettiComplete:function(){y(P()),h(!1)},numberOfPieces:v,recycle:!1,tweenDuration:5e4})]})})}var A,U="YYYYMMDD";!function(e){e[e.PROMPT_FOR_USER_CREDS=0]="PROMPT_FOR_USER_CREDS",e[e.USER_INPUT_ACCEPTED=1]="USER_INPUT_ACCEPTED",e[e.ERROR=2]="ERROR"}(A||(A={}));var Y=function(){var e=Object(c.useState)("9ebcbcde-d6a2-40d6-9ec1-99de1e5e7470"),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)("82efbb68-ab5b-426a-bcad-da7fdc3273bb"),i=Object(o.a)(s,2),u=i[0],l=i[1],d=Object(c.useState)(),j=Object(o.a)(d,2),b=j[0],h=j[1],O=Object(c.useState)(A.USER_INPUT_ACCEPTED),f=Object(o.a)(O,2),p=f[0],m=f[1];return p===A.PROMPT_FOR_USER_CREDS||p===A.ERROR?Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)("h1",{children:"Habitica Tracker"}),b&&Object(a.jsxs)("div",{className:"error",children:["Error: ",b.message]}),Object(a.jsx)("p",{children:"This tool displays a history of your Habits, Dailies and Todos in Habitica."}),Object(a.jsxs)("p",{children:["Your User ID and API key can be found on the"," ",Object(a.jsx)("a",{href:"https://habitica.com/user/settings/api",target:"_blank",rel:"noopener noreferrer",children:"Settings > API"})," ","page in Habitica."]}),Object(a.jsxs)("form",{className:"user-api-form",children:[Object(a.jsxs)("div",{className:"label-container",children:[Object(a.jsx)("div",{className:"label",children:"User ID"}),Object(a.jsx)("input",{type:"text",className:"user-id",value:n,onChange:function(e){r(e.target.value)}})]}),Object(a.jsxs)("div",{className:"label-container",children:[Object(a.jsx)("span",{className:"label",children:"API Key"}),Object(a.jsx)("input",{type:"password",className:"api-key",value:u,onChange:function(e){l(e.target.value)},minLength:36})]}),Object(a.jsx)("div",{className:"submit-wrapper",children:Object(a.jsx)("input",{type:"submit",value:"Fetch My Data",onClick:function(e){e.preventDefault(),m(A.USER_INPUT_ACCEPTED)}})})]}),Object(a.jsx)("h2",{children:"Note"}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:"Your user ID and API key will be sent to the Habitica servers and nowhere else."}),Object(a.jsx)("li",{children:"This app does not change your Habitica account data. It only fetches and displays data."})]})]}):Object(a.jsx)(M,{userId:n,userApiKey:u,setError:function(e){h(e),m(A.ERROR)}})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(112);i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)("div",{className:"app-wrapper",children:Object(a.jsx)(Y,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},38:function(e,t,n){},39:function(e,t,n){}},[[113,1,2]]]);
//# sourceMappingURL=main.1df55853.chunk.js.map