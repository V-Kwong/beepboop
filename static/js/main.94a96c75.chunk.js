(this.webpackJsonpbeepboop=this.webpackJsonpbeepboop||[]).push([[0],{106:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(24),o=a.n(c),s=(a(31),a(2)),i=(a(32),a(6)),l=a(12),u=a.n(l),d=a(3),m=a.n(d),f=a(25),h=a.n(f),p=a(13),b=a.n(p);b.a.setLevel("ERROR");var E=b.a;function v(e){var t=Object(n.useContext)(D);return r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement("div",{className:"section-header"},r.a.createElement("div",{className:"section-header-title",onClick:function(){window.open("https://habitica.com/")}},r.a.createElement("h2",null,e.title)))),t.dates.map((function(e){return r.a.createElement("th",{key:e.toString()},r.a.createElement("div",{className:"date date-heading"},r.a.createElement("span",null,e.format("ddd")),r.a.createElement("span",null,e.format("DD"))))}))))}var y=a(26),O=a(15);function j(e){var t=Object(n.useContext)(D),a=new Map,c=e.habit,o=c.text,s=c.history;E.debug(o);var i,l=Object(y.a)(s);try{for(l.s();!(i=l.n()).done;){var u=i.value,d=m()(u.date).format(H);E.debug(JSON.stringify(u)),void 0!==u.scoredUp&&void 0!==u.scoredDown&&a.set(d,[u.scoredUp,u.scoredDown])}}catch(h){l.e(h)}finally{l.f()}var f=t.dates.map((function(e){return e.format(H)})).map((function(e){return{day:e,score:a.get(e)}}));return 0!==f.filter((function(e){return void 0!==e.score})).length||e.showNoHistory?r.a.createElement("tr",null,r.a.createElement("td",{className:"task-name-row"},r.a.createElement("span",{className:"task-name",dangerouslySetInnerHTML:{__html:O.render(o)}})),f.map((function(e){var t=e.day,a=e.score;return a?r.a.createElement(w,{key:t,up:a[0],down:a[1]}):r.a.createElement("td",{key:t,className:"habit-cell"},"\xa0")}))):null}function w(e){var t=e.up>=4?"success":"fail";return r.a.createElement("td",{className:"habit-cell"},r.a.createElement("div",{className:"habit-score-container"},e.up>0?r.a.createElement("div",{className:[t,"center-wrapper"].join(" ")},r.a.createElement("span",null,"+",e.up)):r.a.createElement("div",{className:"fail center-wrapper"},r.a.createElement("span",null,e.up))))}var N=a(15);function g(e){var t=Object(n.useState)(!0),a=Object(s.a)(t,2),c=a[0],o=a[1];return r.a.createElement("section",{className:"dailys"},r.a.createElement("table",null,r.a.createElement(v,{title:"Habits",setShowNoHistory:o,showNoHistory:c}),r.a.createElement("tbody",null,e.data.map((function(e){return"habit"===e.type?r.a.createElement(j,{key:e.id,showNoHistory:c,habit:e}):r.a.createElement(S,{key:e.id,showNoHistory:c,daily:e})})))),r.a.createElement("div",{className:"link show-no-history",onClick:function(){return o(!c)}}))}function S(e){var t=Object(n.useContext)(D),a=new Map,c=e.daily,o=c.text,s=c.history;E.debug(o);for(var i=1;i<s.length;i++){var l=s[i].value-s[i-1].value,u=m()(s[i].date);if(E.debug(u.format("YYYY-MM-DD HH:mm:ss")+": "+s[i].value),0!==l){if(t.cronIntervals.search(u.unix(),u.unix()).length>0){var d=u.subtract(1,"day");a.has(d.format(H))?a.has(u.format(H))&&E.warn("Too many completions for ".concat(o," on ").concat(u)):u=d}var f=u.format(H);a.set(f,l)}}console.groupEnd();var h=t.dates.map((function(e){return e.format(H)})).map((function(e){return{day:e,delta:a.get(e)}}));return 0!==h.filter((function(e){return void 0!==e.delta})).length||e.showNoHistory?r.a.createElement("tr",null,r.a.createElement("td",{className:"task-name-row"},r.a.createElement("span",{className:"task-name",dangerouslySetInnerHTML:{__html:N.render(o)}})),h.map((function(e){var t=e.day,a=e.delta;return r.a.createElement(k,{key:t,delta:a})}))):null}function k(e){var t,a=["daily-cell"];return e.delta&&0!==e.delta?e.delta>0?(a.push("success"),t="\u2713"):(a.push("fail"),t="\u2716"):(a.push("pass"),t="\xa0"),r.a.createElement("td",{className:a.join(" ")},t&&r.a.createElement("div",{className:"center-wrapper"},r.a.createElement("span",{className:"symbol"},t)))}var R="https://habitica.com/api/v3",C="0d9428fd-d6fa-45f3-a4db-f130e3ef10ea-HabiticaTracker",T="/tasks/user";function P(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}function x(){return e=2e3,t=5e3,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e);var e,t}var D=r.a.createContext({showTaskIcons:!1,dates:Array(),cronIntervals:new u.a});function I(e){var t=Object(n.useState)(P()),a=Object(s.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),d=Object(s.a)(l,2),f=d[0],p=d[1],b=Object(n.useState)(x()),v=Object(s.a)(b,2),y=v[0],O=v[1],j=Object(n.useState)(!0),w=Object(s.a)(j,2),N=w[0],S=w[1],k=Object(n.useState)(!0),I=Object(s.a)(k,2),_=I[0],H=I[1],M=Object(n.useState)(!0),A=Object(s.a)(M,2),U=A[0],Y=A[1],L=Object(n.useState)(7),J=Object(s.a)(L,2),F=J[0],K=(J[1],Object(n.useState)(!1)),W=Object(s.a)(K,2),z=W[0],B=(W[1],Object(n.useState)([])),G=Object(s.a)(B,2),$=G[0],q=G[1],Q=Object(n.useState)([]),V=Object(s.a)(Q,2),X=V[0],Z=V[1],ee=Object(n.useState)([]),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)([]),ce=Object(s.a)(re,2),oe=(ce[0],ce[1]),se=e.userId,ie=e.userApiKey,le=function(e){return fetch(e,{method:"GET",headers:{"Content-Type":"application/json","x-api-user":se,"x-api-key":ie,"x-client":C}})},ue=function(e){if(!e.success)throw new Error(e.message);return e},de=e.setError,me=function(){return le(R+T).then((function(e){return e.json()})).then(ue).then((function(e){Z(e.data.filter((function(e){return"habit"===e.type}))),ne(e.data.filter((function(e){return"daily"===e.type}))),H(!1),console.log(R+T,JSON.stringify(e))}),(function(e){de(e)}))};if(Object(n.useEffect)((function(){function e(){o(P())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),Object(n.useEffect)((function(){le(R+"/user").then((function(e){return e.json()})).then(ue).then((function(e){q(e.data.history.exp.map((function(e){var t=m()(e.date);return[t.unix()-300,t.unix()+300]}))),S(!1)}),(function(e){de(e)}))}),[]),Object(n.useEffect)((function(){me()}),[]),Object(n.useEffect)((function(){le(R+"/tasks/user?type=completedTodos").then((function(e){return e.json()})).then(ue).then((function(e){oe(e.data.filter((function(e){return"todo"===e.type}))),Y(!1)}),(function(e){de(e)}))}),[]),N||_||U)return r.a.createElement("div",{className:"App"},r.a.createElement("p",null,"Loading..."));var fe=new u.a;$.forEach((function(e){E.debug("cron: ".concat(m.a.unix(e[0])," - ").concat(m.a.unix(e[1]))),fe.insert(e[0],e[1],!0)}));var he,pe={showTaskIcons:z,dates:(he=F,Array(he).fill(0).map((function(e,t){return t})).reverse().map((function(e){return m()().subtract(e,"day").startOf("day")}))),cronIntervals:fe};return r.a.createElement("div",{className:"App"},r.a.createElement(D.Provider,{value:pe},r.a.createElement(g,{data:[].concat(Object(i.a)(ae.slice(0,-1)),Object(i.a)(X),Object(i.a)(ae.slice(-1)))}),r.a.createElement("div",{className:"date-header",onClick:function(){return fetch(R+"/tasks/30c753a4-c306-475d-8c2a-464fda9fbaa3/score/up",{method:"POST",headers:{"Content-Type":"application/json","x-api-user":se,"x-api-key":ie,"x-client":C}}).then((function(e){return e.json()})).then(ue).then((function(e){p(!0),console.log(R+"/tasks/30c753a4-c306-475d-8c2a-464fda9fbaa3/score/up",JSON.stringify(e))}),(function(e){de(e)})).then(me)}},"+ Score Pomodoro"),r.a.createElement("div",{className:"date-header",onClick:function(){return fetch(R+"/tasks/13ab931b-b04a-47f0-9555-ad3bc4428dd6/score/up",{method:"POST",headers:{"Content-Type":"application/json","x-api-user":se,"x-api-key":ie,"x-client":C}}).then((function(e){return e.json()})).then(ue).then((function(e){p(!0),console.log(R+"/tasks/13ab931b-b04a-47f0-9555-ad3bc4428dd6/score/up",JSON.stringify(e))}),(function(e){de(e)})).then(me)}},"Check P;ans"),r.a.createElement(h.a,{width:c.width,height:c.height,run:f,onConfettiComplete:function(){O(x()),p(!1)},numberOfPieces:y,recycle:!1,tweenDuration:5e4})))}var _,H="YYYYMMDD";!function(e){e[e.PROMPT_FOR_USER_CREDS=0]="PROMPT_FOR_USER_CREDS",e[e.USER_INPUT_ACCEPTED=1]="USER_INPUT_ACCEPTED",e[e.ERROR=2]="ERROR"}(_||(_={}));var M=function(){var e=Object(n.useState)("9ebcbcde-d6a2-40d6-9ec1-99de1e5e7470"),t=Object(s.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)("82efbb68-ab5b-426a-bcad-da7fdc3273bb"),i=Object(s.a)(o,2),l=i[0],u=i[1],d=Object(n.useState)(),m=Object(s.a)(d,2),f=m[0],h=m[1],p=Object(n.useState)(_.USER_INPUT_ACCEPTED),b=Object(s.a)(p,2),E=b[0],v=b[1];return E===_.PROMPT_FOR_USER_CREDS||E===_.ERROR?r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"Habitica Tracker"),f&&r.a.createElement("div",{className:"error"},"Error: ",f.message),r.a.createElement("p",null,"This tool displays a history of your Habits, Dailies and Todos in Habitica."),r.a.createElement("p",null,"Your User ID and API key can be found on the"," ",r.a.createElement("a",{href:"https://habitica.com/user/settings/api",target:"_blank",rel:"noopener noreferrer"},"Settings > API")," ","page in Habitica."),r.a.createElement("form",{className:"user-api-form"},r.a.createElement("div",{className:"label-container"},r.a.createElement("div",{className:"label"},"User ID"),r.a.createElement("input",{type:"text",className:"user-id",value:a,onChange:function(e){c(e.target.value)}})),r.a.createElement("div",{className:"label-container"},r.a.createElement("span",{className:"label"},"API Key"),r.a.createElement("input",{type:"password",className:"api-key",value:l,onChange:function(e){u(e.target.value)},minLength:36})),r.a.createElement("div",{className:"submit-wrapper"},r.a.createElement("input",{type:"submit",value:"Fetch My Data",onClick:function(e){e.preventDefault(),v(_.USER_INPUT_ACCEPTED)}}))),r.a.createElement("h2",null,"Note"),r.a.createElement("ul",null,r.a.createElement("li",null,"Your user ID and API key will be sent to the Habitica servers and nowhere else."),r.a.createElement("li",null,"This app does not change your Habitica account data. It only fetches and displays data."))):r.a.createElement(I,{userId:a,userApiKey:l,setError:function(e){h(e),v(_.ERROR)}})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement("div",{className:"app-wrapper"},r.a.createElement(M,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},31:function(e,t,a){},32:function(e,t,a){}},[[106,1,2]]]);
//# sourceMappingURL=main.94a96c75.chunk.js.map