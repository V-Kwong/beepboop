(this.webpackJsonpbeepboop=this.webpackJsonpbeepboop||[]).push([[0],{108:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),s=n.n(c),r=n(24),i=n.n(r),o=(n(33),n(3)),d=(n(34),n(7)),u=n(13),l=n.n(u),j=n(4),b=n.n(j),h=n(25),f=n.n(h),O=n(14),p=n.n(O);p.a.setLevel("ERROR");var m=p.a;function x(e){var t=Object(c.useContext)(I);return Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:Object(a.jsx)("div",{className:"section-header",children:Object(a.jsx)("div",{className:"section-header-title",onClick:function(){window.open("https://habitica.com/")},children:Object(a.jsx)("h2",{children:e.title})})})}),t.dates.map((function(e){return Object(a.jsx)("th",{children:Object(a.jsxs)("div",{className:"date date-heading",children:[Object(a.jsx)("span",{children:e.format("ddd")}),Object(a.jsx)("span",{children:e.format("DD")})]})},e.toString())}))]})})}var v=n(26),y=n(15);function w(e){var t=Object(c.useContext)(I),n=new Map,s=e.habit,r=s.text,i=s.history;m.debug(r);var o,d=Object(v.a)(i);try{for(d.s();!(o=d.n()).done;){var u=o.value,l=b()(u.date).format(M);m.debug(JSON.stringify(u)),void 0!==u.scoredUp&&void 0!==u.scoredDown&&n.set(l,[u.scoredUp,u.scoredDown])}}catch(h){d.e(h)}finally{d.f()}var j=t.dates.map((function(e){return e.format(M)})).map((function(e){return{day:e,score:n.get(e)}}));return 0!==j.filter((function(e){return void 0!==e.score})).length||e.showNoHistory?Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{className:"task-name-row",children:Object(a.jsx)("span",{className:"task-name",dangerouslySetInnerHTML:{__html:y.render(r)}})}),j.map((function(e){var t=e.day,n=e.score;return n?Object(a.jsx)(N,{up:n[0],down:n[1]},t):Object(a.jsx)("td",{className:"habit-cell",children:"\xa0"},t)}))]}):null}function N(e){var t=e.up>=4?"success":"fail";return Object(a.jsx)("td",{className:"habit-cell",children:Object(a.jsx)("div",{className:"habit-score-container",children:e.up>0?Object(a.jsx)("div",{className:[t,"center-wrapper"].join(" "),children:Object(a.jsxs)("span",{children:["+",e.up]})}):Object(a.jsx)("div",{className:"fail center-wrapper",children:Object(a.jsx)("span",{children:e.up})})})})}var g=n(15);function S(e){var t=Object(c.useState)(!0),n=Object(o.a)(t,2),s=n[0],r=n[1];return Object(a.jsxs)("section",{className:"dailys",children:[Object(a.jsxs)("table",{children:[Object(a.jsx)(x,{title:"Habits",setShowNoHistory:r,showNoHistory:s}),Object(a.jsx)("tbody",{children:e.data.map((function(e){return"habit"===e.type?Object(a.jsx)(w,{showNoHistory:s,habit:e},e.id):Object(a.jsx)(E,{showNoHistory:s,daily:e},e.id)}))})]}),Object(a.jsx)("div",{className:"link show-no-history",onClick:function(){return r(!s)}})]})}function E(e){var t=Object(c.useContext)(I),n=new Map,s=e.daily,r=s.text,i=s.history;m.debug(r);for(var o=1;o<i.length;o++){var d=i[o].value-i[o-1].value,u=b()(i[o].date);if(m.debug(u.format("YYYY-MM-DD HH:mm:ss")+": "+i[o].value),0!==d){if(t.cronIntervals.search(u.unix(),u.unix()).length>0){var l=u.subtract(1,"day");n.has(l.format(M))?n.has(u.format(M))&&m.warn("Too many completions for ".concat(r," on ").concat(u)):u=l}var j=u.format(M);n.set(j,d)}}console.groupEnd();var h=t.dates.map((function(e){return e.format(M)})).map((function(e){return{day:e,delta:n.get(e)}}));return 0!==h.filter((function(e){return void 0!==e.delta})).length||e.showNoHistory?Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{className:"task-name-row",children:Object(a.jsx)("span",{className:"task-name",dangerouslySetInnerHTML:{__html:g.render(r)}})}),h.map((function(e){var t=e.day,n=e.delta;return Object(a.jsx)(k,{delta:n},t)}))]}):null}function k(e){var t,n=["daily-cell"];return e.delta&&0!==e.delta?e.delta>0?(n.push("success"),t="\u2713"):(n.push("fail"),t="\u2716"):(n.push("pass"),t="\xa0"),Object(a.jsx)("td",{className:n.join(" "),children:t&&Object(a.jsx)("div",{className:"center-wrapper",children:Object(a.jsx)("span",{className:"symbol",children:t})})})}var R="https://habitica.com/api/v3",T="0d9428fd-d6fa-45f3-a4db-f130e3ef10ea-HabiticaTracker",C="/tasks/user";function P(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}function D(){return e=2e3,t=5e3,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e);var e,t}var I=s.a.createContext({showTaskIcons:!1,dates:Array(),cronIntervals:new l.a});function _(e){var t=Object(c.useState)(P()),n=Object(o.a)(t,2),s=n[0],r=n[1],i=Object(c.useState)(!1),u=Object(o.a)(i,2),j=u[0],h=u[1],O=Object(c.useState)(D()),p=Object(o.a)(O,2),x=p[0],v=p[1],y=Object(c.useState)(!0),w=Object(o.a)(y,2),N=w[0],g=w[1],E=Object(c.useState)(!0),k=Object(o.a)(E,2),_=k[0],H=k[1],M=Object(c.useState)(!0),A=Object(o.a)(M,2),U=A[0],Y=A[1],L=Object(c.useState)(7),J=Object(o.a)(L,2),F=J[0],K=(J[1],Object(c.useState)(!1)),W=Object(o.a)(K,2),z=W[0],B=(W[1],Object(c.useState)([])),G=Object(o.a)(B,2),$=G[0],q=G[1],Q=Object(c.useState)([]),V=Object(o.a)(Q,2),X=V[0],Z=V[1],ee=Object(c.useState)([]),te=Object(o.a)(ee,2),ne=te[0],ae=te[1],ce=Object(c.useState)([]),se=Object(o.a)(ce,2),re=(se[0],se[1]),ie=e.userId,oe=e.userApiKey,de=function(e){return fetch(e,{method:"GET",headers:{"Content-Type":"application/json","x-api-user":ie,"x-api-key":oe,"x-client":T}})},ue=function(e){if(!e.success)throw new Error(e.message);return e},le=e.setError,je=function(){return de(R+C).then((function(e){return e.json()})).then(ue).then((function(e){Z(e.data.filter((function(e){return"habit"===e.type}))),ae(e.data.filter((function(e){return"daily"===e.type}))),H(!1),console.log(R+C,JSON.stringify(e))}),(function(e){le(e)}))};if(Object(c.useEffect)((function(){function e(){r(P())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),Object(c.useEffect)((function(){de(R+"/user").then((function(e){return e.json()})).then(ue).then((function(e){q(e.data.history.exp.map((function(e){var t=b()(e.date);return[t.unix()-300,t.unix()+300]}))),g(!1)}),(function(e){le(e)}))}),[]),Object(c.useEffect)((function(){je()}),[]),Object(c.useEffect)((function(){de(R+"/tasks/user?type=completedTodos").then((function(e){return e.json()})).then(ue).then((function(e){re(e.data.filter((function(e){return"todo"===e.type}))),Y(!1)}),(function(e){le(e)}))}),[]),N||_||U)return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)("p",{children:"Loading..."})});var be=new l.a;$.forEach((function(e){m.debug("cron: ".concat(b.a.unix(e[0])," - ").concat(b.a.unix(e[1]))),be.insert(e[0],e[1],!0)}));var he,fe={showTaskIcons:z,dates:(he=F,Array(he).fill(0).map((function(e,t){return t})).reverse().map((function(e){return b()().subtract(e,"day").startOf("day")}))),cronIntervals:be};return Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(I.Provider,{value:fe,children:[Object(a.jsx)(S,{data:[].concat(Object(d.a)(ne.slice(0,-1)),Object(d.a)(X),Object(d.a)(ne.slice(-1)))}),Object(a.jsxs)("div",{className:"buttons-container",children:[Object(a.jsx)("div",{className:"button-container",onClick:function(){return fetch(R+"/tasks/30c753a4-c306-475d-8c2a-464fda9fbaa3/score/up",{method:"POST",headers:{"Content-Type":"application/json","x-api-user":ie,"x-api-key":oe,"x-client":T}}).then((function(e){return e.json()})).then(ue).then((function(e){h(!0),console.log(R+"/tasks/30c753a4-c306-475d-8c2a-464fda9fbaa3/score/up",JSON.stringify(e))}),(function(e){le(e)})).then(je)},children:"\u2714  Pomodoro"}),Object(a.jsx)("div",{className:"button-container",onClick:function(){return fetch(R+"/tasks/13ab931b-b04a-47f0-9555-ad3bc4428dd6/score/up",{method:"POST",headers:{"Content-Type":"application/json","x-api-user":ie,"x-api-key":oe,"x-client":T}}).then((function(e){return e.json()})).then(ue).then((function(e){h(!0),console.log(R+"/tasks/13ab931b-b04a-47f0-9555-ad3bc4428dd6/score/up",JSON.stringify(e))}),(function(e){le(e)})).then(je)},children:"\u2714  Plan"})]}),Object(a.jsx)(f.a,{width:s.width,height:s.height,run:j,onConfettiComplete:function(){v(D()),h(!1)},numberOfPieces:x,recycle:!1,tweenDuration:5e4})]})})}var H,M="YYYYMMDD";!function(e){e[e.PROMPT_FOR_USER_CREDS=0]="PROMPT_FOR_USER_CREDS",e[e.USER_INPUT_ACCEPTED=1]="USER_INPUT_ACCEPTED",e[e.ERROR=2]="ERROR"}(H||(H={}));var A=function(){var e=Object(c.useState)("9ebcbcde-d6a2-40d6-9ec1-99de1e5e7470"),t=Object(o.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)("82efbb68-ab5b-426a-bcad-da7fdc3273bb"),i=Object(o.a)(r,2),d=i[0],u=i[1],l=Object(c.useState)(),j=Object(o.a)(l,2),b=j[0],h=j[1],f=Object(c.useState)(H.USER_INPUT_ACCEPTED),O=Object(o.a)(f,2),p=O[0],m=O[1];return p===H.PROMPT_FOR_USER_CREDS||p===H.ERROR?Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)("h1",{children:"Habitica Tracker"}),b&&Object(a.jsxs)("div",{className:"error",children:["Error: ",b.message]}),Object(a.jsx)("p",{children:"This tool displays a history of your Habits, Dailies and Todos in Habitica."}),Object(a.jsxs)("p",{children:["Your User ID and API key can be found on the"," ",Object(a.jsx)("a",{href:"https://habitica.com/user/settings/api",target:"_blank",rel:"noopener noreferrer",children:"Settings > API"})," ","page in Habitica."]}),Object(a.jsxs)("form",{className:"user-api-form",children:[Object(a.jsxs)("div",{className:"label-container",children:[Object(a.jsx)("div",{className:"label",children:"User ID"}),Object(a.jsx)("input",{type:"text",className:"user-id",value:n,onChange:function(e){s(e.target.value)}})]}),Object(a.jsxs)("div",{className:"label-container",children:[Object(a.jsx)("span",{className:"label",children:"API Key"}),Object(a.jsx)("input",{type:"password",className:"api-key",value:d,onChange:function(e){u(e.target.value)},minLength:36})]}),Object(a.jsx)("div",{className:"submit-wrapper",children:Object(a.jsx)("input",{type:"submit",value:"Fetch My Data",onClick:function(e){e.preventDefault(),m(H.USER_INPUT_ACCEPTED)}})})]}),Object(a.jsx)("h2",{children:"Note"}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:"Your user ID and API key will be sent to the Habitica servers and nowhere else."}),Object(a.jsx)("li",{children:"This app does not change your Habitica account data. It only fetches and displays data."})]})]}):Object(a.jsx)(_,{userId:n,userApiKey:d,setError:function(e){h(e),m(H.ERROR)}})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)("div",{className:"app-wrapper",children:Object(a.jsx)(A,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},33:function(e,t,n){},34:function(e,t,n){}},[[108,1,2]]]);
//# sourceMappingURL=main.eae1b749.chunk.js.map