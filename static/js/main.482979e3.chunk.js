(this.webpackJsonpbeepboop=this.webpackJsonpbeepboop||[]).push([[0],{111:function(e,t,n){},112:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(26),c=n.n(r),i=(n(33),n(4)),o=(n(34),n(13)),l=n.n(o),d=n(5),j=n.n(d),u=n(14),b=n.n(u);b.a.setLevel("ERROR");var h,O=b.a,f=n(27),x=["title","titleId"];function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},p.apply(this,arguments)}function m(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function v(e,t){var n=e.title,s=e.titleId,r=m(e,x);return a.createElement("svg",p({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 16 16",ref:t,"aria-labelledby":s},r),n?a.createElement("title",{id:s},n):null,h||(h=a.createElement("path",{fillRule:"evenodd",d:"M10.667 10.667L16 8l-5.333-2.667L8 0 5.333 5.333 0 8l5.333 2.667L8 16z"})))}var y=a.forwardRef(v),w=(n.p,n(38),n(1));function N(e){var t,n,r=Object(a.useContext)(J),c=["task-icon-container","center-wrapper",T(e.task)].join(" "),i=(t=e.task.priority,Math.ceil(t/.5)),o=Array.from({length:i},(function(e,t){return Object(w.jsx)(y,{fill:"white","aria-hidden":!0},t)})),l=e.task.value.toFixed(1);return e.task.nextDue&&(n=j()(e.task.nextDue[0])),r.showTaskIcons?Object(w.jsxs)(s.a.Fragment,{children:[Object(w.jsx)("div",{"data-tip":!0,"data-for":e.task.id,className:c,children:o}),Object(w.jsxs)(f.a,{id:e.task.id,place:"left",effect:"solid",children:[n?Object(w.jsxs)("div",{children:[Object(w.jsx)("b",{children:"Next due:"})," ",g(n)]}):null,Object(w.jsxs)("div",{children:[Object(w.jsx)("b",{children:"Task value:"})," ",l]})]})]}):null}function g(e){var t=j()();return e.diff(t,"day")<1?"tomorrow":e.diff(t,"day")<6?e.format("dddd"):e.year===j()().year?e.format("ddd MMM D"):e.format("MMM D YYYY")}var k=[-16,-9,-1,1,6,12],S=["worst","worse","bad","neutral","good","better"];function T(e){for(var t=0;t<k.length;t++)if(e.value<k[t])return S[t];return"best"}var E=n(15);function M(e){var t=Object(a.useContext)(J);return Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:Object(w.jsx)("div",{className:"section-header",children:Object(w.jsxs)("div",{className:"section-header-title",children:[Object(w.jsx)("h2",{children:e.title}),Object(w.jsx)("div",{role:"button",className:"show-no-history clickable",title:"Show/Hide tasks with no data",onClick:function(){return e.setShowNoHistory(!e.showNoHistory)},children:e.showNoHistory?Object(w.jsx)(E.a,{"aria-hidden":"true"}):Object(w.jsx)(E.b,{"aria-hidden":"true"})})]})})}),t.dates.map((function(e){return Object(w.jsx)("th",{children:Object(w.jsxs)("div",{className:"date date-heading",children:[Object(w.jsx)("span",{children:e.format("ddd")}),Object(w.jsx)("span",{children:e.format("DD")})]})},e.toString())}))]})})}var D=n(7);function R(e){var t=Object(a.useState)(!1),n=Object(i.a)(t,2),s=n[0],r=n[1];return Object(w.jsxs)("section",{className:"dailys",children:[Object(w.jsxs)("table",{children:[Object(w.jsx)(M,{title:"Dailies",setShowNoHistory:r,showNoHistory:s}),Object(w.jsx)("tbody",{children:e.data.map((function(e){return Object(w.jsx)(I,{showNoHistory:s,daily:e},e.id)}))})]}),Object(w.jsx)("div",{className:"link show-no-history",onClick:function(){return r(!s)}})]})}function I(e){var t=Object(a.useContext)(J),n=new Map,s=e.daily,r=s.text,c=s.history;O.debug(r);for(var i=1;i<c.length;i++){var o=c[i].value-c[i-1].value,l=j()(c[i].date);if(O.debug(l.format("YYYY-MM-DD HH:mm:ss")+": "+c[i].value),0!==o){if(t.cronIntervals.search(l.unix(),l.unix()).length>0){var d=l.subtract(1,"day");n.has(d.format(G))?n.has(l.format(G))&&O.warn("Too many completions for ".concat(r," on ").concat(l)):l=d}var u=l.format(G);n.set(u,o)}}console.groupEnd();var b=t.dates.map((function(e){return e.format(G)})).map((function(e){return{day:e,delta:n.get(e)}}));return 0!==b.filter((function(e){return void 0!==e.delta})).length||e.showNoHistory?Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{className:"task-name-row",children:[Object(w.jsx)(N,{task:e.daily}),Object(w.jsx)("span",{className:"task-name",dangerouslySetInnerHTML:{__html:D.render(r)}})]}),b.map((function(e){var t=e.day,n=e.delta;return Object(w.jsx)(C,{delta:n},t)}))]}):null}function C(e){var t,n=["daily-cell"];return e.delta&&0!==e.delta?e.delta>0?(n.push("success"),t="\u2713"):(n.push("fail"),t="\u2716"):(n.push("pass"),t="\xa0"),Object(w.jsx)("td",{className:n.join(" "),children:t&&Object(w.jsx)("div",{className:"center-wrapper",children:Object(w.jsx)("span",{className:"symbol",children:t})})})}var H=n(28),Y=n(7);function _(e){var t=Object(a.useState)(!1),n=Object(i.a)(t,2),s=n[0],r=n[1];return Object(w.jsx)("section",{className:"habits",children:Object(w.jsxs)("table",{children:[Object(w.jsx)(M,{title:"Habits",setShowNoHistory:r,showNoHistory:s}),Object(w.jsx)("tbody",{children:e.data.map((function(e){return Object(w.jsx)(P,{showNoHistory:s,habit:e},e.id)}))})]})})}function P(e){var t=Object(a.useContext)(J),n=new Map,s=e.habit,r=s.text,c=s.history;O.debug(r);var i,o=Object(H.a)(c);try{for(o.s();!(i=o.n()).done;){var l=i.value,d=j()(l.date).format(G);O.debug(JSON.stringify(l)),void 0!==l.scoredUp&&void 0!==l.scoredDown&&n.set(d,[l.scoredUp,l.scoredDown])}}catch(b){o.e(b)}finally{o.f()}var u=t.dates.map((function(e){return e.format(G)})).map((function(e){return{day:e,score:n.get(e)}}));return 0!==u.filter((function(e){return void 0!==e.score})).length||e.showNoHistory?Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{className:"task-name-row",children:[Object(w.jsx)(N,{task:e.habit}),Object(w.jsx)("span",{className:"task-name",dangerouslySetInnerHTML:{__html:Y.render(r)}})]}),u.map((function(e){var t=e.day,n=e.score;return n?Object(w.jsx)(A,{up:n[0],down:n[1]},t):Object(w.jsx)("td",{className:"habit-cell",children:"\xa0"},t)}))]}):null}function A(e){return Object(w.jsx)("td",{className:"habit-cell",children:Object(w.jsxs)("div",{className:"habit-score-container",children:[e.up>0&&Object(w.jsx)("div",{className:"success center-wrapper",children:Object(w.jsxs)("span",{children:["+",e.up]})}),e.down>0&&Object(w.jsx)("div",{className:"fail center-wrapper",children:Object(w.jsxs)("span",{children:["-",e.down]})})]})})}n(111);var U=n(7);function L(e){var t=Object(a.useContext)(J).dates[0],n=e.data.filter((function(e){return j()(e.dateCompleted).isAfter(t)}));return Object(w.jsxs)("section",{className:"todos",children:[Object(w.jsx)("h2",{children:"Completed Todos"}),Object(w.jsx)("ul",{children:n.map((function(e){return Object(w.jsx)(F,{todo:e},e.id)}))})]})}function F(e){var t=j()(e.todo.dateCompleted).format("MMM D");return Object(w.jsxs)("li",{className:"todo-row",children:[Object(w.jsx)(N,{task:e.todo}),Object(w.jsx)("span",{className:"todo-date date",children:t}),Object(w.jsx)("div",{className:"task-name",dangerouslySetInnerHTML:{__html:U.render(e.todo.text)}})]})}var B="https://habitica.com/api/v3",J=s.a.createContext({showTaskIcons:!0,dates:Array(),cronIntervals:new l.a});function K(e){var t=Object(a.useState)(!0),n=Object(i.a)(t,2),s=n[0],r=n[1],c=Object(a.useState)(!0),o=Object(i.a)(c,2),d=o[0],u=o[1],b=Object(a.useState)(!0),h=Object(i.a)(b,2),f=h[0],x=h[1],p=Object(a.useState)(7),m=Object(i.a)(p,2),v=m[0],y=m[1],N=Object(a.useState)(!0),g=Object(i.a)(N,2),k=g[0],S=g[1],T=Object(a.useState)([]),E=Object(i.a)(T,2),M=E[0],D=E[1],I=Object(a.useState)([]),C=Object(i.a)(I,2),H=C[0],Y=C[1],P=Object(a.useState)([]),A=Object(i.a)(P,2),U=A[0],F=A[1],K=Object(a.useState)([]),z=Object(i.a)(K,2),G=z[0],$=z[1],q=e.userId,Q=e.userApiKey,V=function(e){return fetch(e,{method:"GET",headers:{"Content-Type":"application/json","x-api-user":q,"x-api-key":Q,"x-client":"0d9428fd-d6fa-45f3-a4db-f130e3ef10ea-HabiticaTracker"}})},X=function(e){if(!e.success)throw new Error(e.message);return e},Z=e.setError;if(Object(a.useEffect)((function(){V(B+"/user").then((function(e){return e.json()})).then(X).then((function(e){D(e.data.history.exp.map((function(e){var t=j()(e.date);return[t.unix()-300,t.unix()+300]}))),r(!1)}),(function(e){Z(e)}))}),[]),Object(a.useEffect)((function(){V(B+"/tasks/user").then((function(e){return e.json()})).then(X).then((function(e){Y(e.data.filter((function(e){return"habit"===e.type}))),F(e.data.filter((function(e){return"daily"===e.type}))),u(!1)}),(function(e){Z(e)}))}),[]),Object(a.useEffect)((function(){V(B+"/tasks/user?type=completedTodos").then((function(e){return e.json()})).then(X).then((function(e){$(e.data.filter((function(e){return"todo"===e.type}))),x(!1)}),(function(e){Z(e)}))}),[]),s||d||f)return Object(w.jsx)("div",{className:"App",children:Object(w.jsx)("p",{children:"Loading..."})});var ee=new l.a;M.forEach((function(e){O.debug("cron: ".concat(j.a.unix(e[0])," - ").concat(j.a.unix(e[1]))),ee.insert(e[0],e[1],!0)}));var te,ne={showTaskIcons:k,dates:(te=v,Array(te).fill(0).map((function(e,t){return t+1})).reverse().map((function(e){return j()().subtract(e,"day").startOf("day")}))),cronIntervals:ee};return Object(w.jsx)("div",{className:"App",children:Object(w.jsxs)(J.Provider,{value:ne,children:[Object(w.jsx)(W,{numDaysToShow:v,setNumDaysToShow:y,toggleTaskIcons:function(){return S(!k)}}),Object(w.jsx)(_,{data:H}),Object(w.jsx)(R,{data:U}),Object(w.jsx)(L,{data:G})]})})}function W(e){var t=Object(a.useContext)(J),n=function(e){var t=e[0],n=e[e.length-1];if(t.month()===n.month())return n.format("MMMM YYYY");var a=t.year()===n.year()?"MMM":"MMM YYYY",s="MMM YYYY";return[t.format(a),n.format(s)].join("\u2013")}(t.dates);return Object(w.jsxs)("div",{className:"app-controls",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{role:"button",className:"link",onClick:function(){return e.setNumDaysToShow(e.numDaysToShow+7)},children:"+1 week"}),e.numDaysToShow>7?Object(w.jsxs)("span",{children:[Object(w.jsx)("span",{children:" / "}),Object(w.jsx)("span",{role:"button",className:"link",onClick:function(){return e.setNumDaysToShow(e.numDaysToShow-7)},children:"-1 week"})]}):null]}),Object(w.jsx)("div",{className:"date-header",children:n}),Object(w.jsxs)("span",{role:"button",className:"link",onClick:e.toggleTaskIcons,title:"Show/Hide task icons",children:[t.showTaskIcons?"-":"+"," Task Icons"]})]})}var z,G="YYYYMMDD";!function(e){e[e.PROMPT_FOR_USER_CREDS=0]="PROMPT_FOR_USER_CREDS",e[e.USER_INPUT_ACCEPTED=1]="USER_INPUT_ACCEPTED",e[e.ERROR=2]="ERROR"}(z||(z={}));var $=function(){var e=Object(a.useState)("9ebcbcde-d6a2-40d6-9ec1-99de1e5e7470"),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(a.useState)("82efbb68-ab5b-426a-bcad-da7fdc3273bb"),c=Object(i.a)(r,2),o=c[0],l=c[1],d=Object(a.useState)(),j=Object(i.a)(d,2),u=j[0],b=j[1],h=Object(a.useState)(z.USER_INPUT_ACCEPTED),O=Object(i.a)(h,2),f=O[0],x=O[1];return f===z.PROMPT_FOR_USER_CREDS||f===z.ERROR?Object(w.jsxs)("div",{className:"App",children:[Object(w.jsx)("h1",{children:"Habitica Tracker"}),u&&Object(w.jsxs)("div",{className:"error",children:["Error: ",u.message]}),Object(w.jsx)("p",{children:"This tool displays a history of your Habits, Dailies and Todos in Habitica."}),Object(w.jsxs)("p",{children:["Your User ID and API key can be found on the"," ",Object(w.jsx)("a",{href:"https://habitica.com/user/settings/api",target:"_blank",rel:"noopener noreferrer",children:"Settings > API"})," ","page in Habitica."]}),Object(w.jsxs)("form",{className:"user-api-form",children:[Object(w.jsxs)("div",{className:"label-container",children:[Object(w.jsx)("div",{className:"label",children:"User ID"}),Object(w.jsx)("input",{type:"text",className:"user-id",value:n,onChange:function(e){s(e.target.value)}})]}),Object(w.jsxs)("div",{className:"label-container",children:[Object(w.jsx)("span",{className:"label",children:"API Key"}),Object(w.jsx)("input",{type:"password",className:"api-key",value:o,onChange:function(e){l(e.target.value)},minLength:36})]}),Object(w.jsx)("div",{className:"submit-wrapper",children:Object(w.jsx)("input",{type:"submit",value:"Fetch My Data",onClick:function(e){e.preventDefault(),x(z.USER_INPUT_ACCEPTED)}})})]}),Object(w.jsx)("h2",{children:"Note"}),Object(w.jsxs)("ul",{children:[Object(w.jsx)("li",{children:"Your user ID and API key will be sent to the Habitica servers and nowhere else."}),Object(w.jsx)("li",{children:"This app does not change your Habitica account data. It only fetches and displays data."})]})]}):Object(w.jsx)(K,{userId:n,userApiKey:o,setError:function(e){b(e),x(z.ERROR)}})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(w.jsx)(s.a.StrictMode,{children:Object(w.jsx)("div",{className:"app-wrapper",children:Object(w.jsx)($,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},33:function(e,t,n){},34:function(e,t,n){},38:function(e,t,n){}},[[112,1,2]]]);
//# sourceMappingURL=main.482979e3.chunk.js.map