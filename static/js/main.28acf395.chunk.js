(this.webpackJsonpbeepboop=this.webpackJsonpbeepboop||[]).push([[0],{103:function(e,t,a){},104:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(22),r=a.n(s),i=(a(27),a(3)),o=(a(28),a(10)),d=a.n(o),l=a(4),j=a.n(l),u=a(11),b=a.n(u);b.a.setLevel("ERROR");var h=b.a,O=a(0);function f(e){var t=Object(n.useContext)(w);return Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:Object(O.jsx)("div",{className:"section-header",children:Object(O.jsx)("div",{className:"section-header-title",children:Object(O.jsx)("h2",{children:e.title})})})}),t.dates.map((function(e){return Object(O.jsx)("th",{children:Object(O.jsxs)("div",{className:"date date-heading",children:[Object(O.jsx)("span",{children:e.format("ddd")}),Object(O.jsx)("span",{children:e.format("DD")})]})},e.toString())}))]})})}var p=a(13);function m(e){var t=Object(n.useState)(!0),a=Object(i.a)(t,2),c=a[0],s=a[1];return Object(O.jsxs)("section",{className:"dailys",children:[Object(O.jsxs)("table",{children:[Object(O.jsx)(f,{title:"Dailies",setShowNoHistory:s,showNoHistory:c}),Object(O.jsx)("tbody",{children:e.data.map((function(e){return Object(O.jsx)(x,{showNoHistory:c,daily:e},e.id)}))})]}),Object(O.jsx)("div",{className:"link show-no-history",onClick:function(){return s(!c)}})]})}function x(e){var t=Object(n.useContext)(w),a=new Map,c=e.daily,s=c.text,r=c.history;h.debug(s);for(var i=1;i<r.length;i++){var o=r[i].value-r[i-1].value,d=j()(r[i].date);if(h.debug(d.format("YYYY-MM-DD HH:mm:ss")+": "+r[i].value),0!==o){if(t.cronIntervals.search(d.unix(),d.unix()).length>0){var l=d.subtract(1,"day");a.has(l.format(T))?a.has(d.format(T))&&h.warn("Too many completions for ".concat(s," on ").concat(d)):d=l}var u=d.format(T);a.set(u,o)}}console.groupEnd();var b=t.dates.map((function(e){return e.format(T)})).map((function(e){return{day:e,delta:a.get(e)}}));return 0!==b.filter((function(e){return void 0!==e.delta})).length||e.showNoHistory?Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{className:"task-name-row",children:Object(O.jsx)("span",{className:"task-name",dangerouslySetInnerHTML:{__html:p.render(s)}})}),b.map((function(e){var t=e.day,a=e.delta;return Object(O.jsx)(v,{delta:a},t)}))]}):null}function v(e){var t,a=["daily-cell"];return e.delta&&0!==e.delta?e.delta>0?(a.push("success"),t="\u2713"):(a.push("fail"),t="\u2716"):(a.push("pass"),t="\xa0"),Object(O.jsx)("td",{className:a.join(" "),children:t&&Object(O.jsx)("div",{className:"center-wrapper",children:Object(O.jsx)("span",{className:"symbol",children:t})})})}a(103);var y=a(13);function N(e){var t=Object(n.useContext)(w).dates[0],a=e.data.filter((function(e){return j()(e.dateCompleted).isAfter(t)}));return Object(O.jsxs)("section",{className:"todos",children:[Object(O.jsx)("h2",{children:"Completed Todos"}),Object(O.jsx)("ul",{children:a.map((function(e){return Object(O.jsx)(E,{todo:e},e.id)}))})]})}function E(e){var t=j()(e.todo.dateCompleted).format("MMM D");return Object(O.jsxs)("li",{className:"todo-row",children:[Object(O.jsx)("span",{className:"todo-date date",children:t}),Object(O.jsx)("div",{className:"task-name",dangerouslySetInnerHTML:{__html:y.render(e.todo.text)}})]})}var g="https://habitica.com/api/v3",w=c.a.createContext({showTaskIcons:!1,dates:Array(),cronIntervals:new d.a});function S(e){var t=Object(n.useState)(!0),a=Object(i.a)(t,2),c=a[0],s=a[1],r=Object(n.useState)(!0),o=Object(i.a)(r,2),l=o[0],u=o[1],b=Object(n.useState)(!0),f=Object(i.a)(b,2),p=f[0],x=f[1],v=Object(n.useState)(7),y=Object(i.a)(v,2),E=y[0],S=y[1],M=Object(n.useState)(!1),T=Object(i.a)(M,2),C=T[0],k=T[1],D=Object(n.useState)([]),I=Object(i.a)(D,2),Y=I[0],_=I[1],P=Object(n.useState)([]),A=Object(i.a)(P,2),H=(A[0],A[1]),U=Object(n.useState)([]),L=Object(i.a)(U,2),F=L[0],K=L[1],B=Object(n.useState)([]),J=Object(i.a)(B,2),W=J[0],G=J[1],$=e.userId,q=e.userApiKey,z=function(e){return fetch(e,{method:"GET",headers:{"Content-Type":"application/json","x-api-user":$,"x-api-key":q,"x-client":"0d9428fd-d6fa-45f3-a4db-f130e3ef10ea-HabiticaTracker"}})},Q=function(e){if(!e.success)throw new Error(e.message);return e},V=e.setError;if(Object(n.useEffect)((function(){z(g+"/user").then((function(e){return e.json()})).then(Q).then((function(e){_(e.data.history.exp.map((function(e){var t=j()(e.date);return[t.unix()-300,t.unix()+300]}))),s(!1)}),(function(e){V(e)}))}),[]),Object(n.useEffect)((function(){z(g+"/tasks/user").then((function(e){return e.json()})).then(Q).then((function(e){H(e.data.filter((function(e){return"habit"===e.type}))),K(e.data.filter((function(e){return"daily"===e.type}))),u(!1)}),(function(e){V(e)}))}),[]),Object(n.useEffect)((function(){z(g+"/tasks/user?type=completedTodos").then((function(e){return e.json()})).then(Q).then((function(e){G(e.data.filter((function(e){return"todo"===e.type}))),x(!1)}),(function(e){V(e)}))}),[]),c||l||p)return Object(O.jsx)("div",{className:"App",children:Object(O.jsx)("p",{children:"Loading..."})});var X=new d.a;Y.forEach((function(e){h.debug("cron: ".concat(j.a.unix(e[0])," - ").concat(j.a.unix(e[1]))),X.insert(e[0],e[1],!0)}));var Z,ee={showTaskIcons:C,dates:(Z=E,Array(Z).fill(0).map((function(e,t){return t})).reverse().map((function(e){return j()().subtract(e,"day").startOf("day")}))),cronIntervals:X};return Object(O.jsx)("div",{className:"App",children:Object(O.jsxs)(w.Provider,{value:ee,children:[Object(O.jsx)(R,{numDaysToShow:E,setNumDaysToShow:S,toggleTaskIcons:function(){return k(!C)}}),Object(O.jsx)("div",{className:"identity",children:Object(O.jsx)("span",{children:"Ambitious \u2666 Mindful \u2666 Disciplined"})}),Object(O.jsx)(m,{data:F}),Object(O.jsx)(N,{data:W})]})})}function R(e){var t=function(){window.open("https://habitica.com/")},a=function(e){var t=e[0],a=e[e.length-1];if(t.month()===a.month())return a.format("MMMM YYYY");var n=t.year()===a.year()?"MMM":"MMM YYYY",c="MMM YYYY";return[t.format(n),a.format(c)].join("\u2013")}(Object(n.useContext)(w).dates);return Object(O.jsxs)("div",{className:"app-controls",children:[Object(O.jsx)("div",{className:"date-header",onClick:t,children:a}),Object(O.jsx)("div",{className:"date-header",onClick:t,children:"Habitica"})]})}var M,T="YYYYMMDD";!function(e){e[e.PROMPT_FOR_USER_CREDS=0]="PROMPT_FOR_USER_CREDS",e[e.USER_INPUT_ACCEPTED=1]="USER_INPUT_ACCEPTED",e[e.ERROR=2]="ERROR"}(M||(M={}));var C=function(){var e=Object(n.useState)("9ebcbcde-d6a2-40d6-9ec1-99de1e5e7470"),t=Object(i.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)("82efbb68-ab5b-426a-bcad-da7fdc3273bb"),r=Object(i.a)(s,2),o=r[0],d=r[1],l=Object(n.useState)(),j=Object(i.a)(l,2),u=j[0],b=j[1],h=Object(n.useState)(M.USER_INPUT_ACCEPTED),f=Object(i.a)(h,2),p=f[0],m=f[1];return p===M.PROMPT_FOR_USER_CREDS||p===M.ERROR?Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)("h1",{children:"Habitica Tracker"}),u&&Object(O.jsxs)("div",{className:"error",children:["Error: ",u.message]}),Object(O.jsx)("p",{children:"This tool displays a history of your Habits, Dailies and Todos in Habitica."}),Object(O.jsxs)("p",{children:["Your User ID and API key can be found on the"," ",Object(O.jsx)("a",{href:"https://habitica.com/user/settings/api",target:"_blank",rel:"noopener noreferrer",children:"Settings > API"})," ","page in Habitica."]}),Object(O.jsxs)("form",{className:"user-api-form",children:[Object(O.jsxs)("div",{className:"label-container",children:[Object(O.jsx)("div",{className:"label",children:"User ID"}),Object(O.jsx)("input",{type:"text",className:"user-id",value:a,onChange:function(e){c(e.target.value)}})]}),Object(O.jsxs)("div",{className:"label-container",children:[Object(O.jsx)("span",{className:"label",children:"API Key"}),Object(O.jsx)("input",{type:"password",className:"api-key",value:o,onChange:function(e){d(e.target.value)},minLength:36})]}),Object(O.jsx)("div",{className:"submit-wrapper",children:Object(O.jsx)("input",{type:"submit",value:"Fetch My Data",onClick:function(e){e.preventDefault(),m(M.USER_INPUT_ACCEPTED)}})})]}),Object(O.jsx)("h2",{children:"Note"}),Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:"Your user ID and API key will be sent to the Habitica servers and nowhere else."}),Object(O.jsx)("li",{children:"This app does not change your Habitica account data. It only fetches and displays data."})]})]}):Object(O.jsx)(S,{userId:a,userApiKey:o,setError:function(e){b(e),m(M.ERROR)}})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)("div",{className:"app-wrapper",children:Object(O.jsx)(C,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},27:function(e,t,a){},28:function(e,t,a){}},[[104,1,2]]]);
//# sourceMappingURL=main.28acf395.chunk.js.map